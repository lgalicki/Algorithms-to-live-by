"""
Created on Sun Dec 22 11:01:18 2019

@author: luciano

Win-stay lose-shift method is here. At first it chooses an arm at random and
then it keeps on playing it until it loses. Then it moves to the next arm and
repeats the same. At first this was made up for a two armed banditm but here
I prepared the method to work with a bandit with more arms. It will basically
choose the next arm to play, after a loss, randomly.

If you want to test it solely, ruh this script, otherwise, if you wish to make
comparisions between methods using a same bandit, import this method into
another script.
"""

from random import randint
from bandit import Bandit
from bandit import Result
from cleaner import clear_screen

def win_stay_lose_shift(bandit, nr_plays):
    """
    Keeps on playing an arm as long as it's winning. When the arm causes a loss,
    changes to another arm and repeats the process.

    Parameters
    ----------
    bandit : Bandit
        A Bandit object.
    nr_plays : int
        The ammount of times you wish to play the bandit's arms

    Returns
    -------
    result : Result
        As defined by the class Result.
    """
    #First let's allocate the result object.
    result = Result(bandit)

    #Game time!
    loss = True
    arm = int()

    for _ in range(nr_plays):
        #If the last round was a loss, we gotta choose a new arm. This if will
        #also choose the first arm in the first round.
        if loss:
            prev_arm = arm
            while prev_arm == arm:
                arm = randint(0, len(bandit) - 1)

        play_result = bandit.play_arm(arm)

        #Registering the result
        if play_result:
            result.win(arm)
            loss = False
        else:
            result.loss(arm)
            loss = True

    return result


if __name__ == '__main__':
    while True:
        try:
            clear_screen()
            QT_ARMS = int(input('How many arms should the bandit have? '))
        except:
            continue
        else:
            if QT_ARMS > 1:
                break
            continue

    while True:
        try:
            QT_PLAYS = int(input('How times do you want to play the bandit? '))
        except:
            continue
        else:
            if QT_PLAYS > 0:
                break
            continue

    BANDIT = Bandit(QT_ARMS)
    WSLS_RESULT = win_stay_lose_shift(BANDIT, QT_PLAYS)

    clear_screen()
    print(BANDIT)
    print(WSLS_RESULT)
